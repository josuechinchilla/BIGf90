% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bf90_cv.R
\name{bf90_cv}
\alias{bf90_cv}
\title{Run K-fold cross-validation analysis (CVA)}
\usage{
bf90_cv(
  path_2_execs,
  missing_value_code,
  random_effect_col,
  h2,
  num_runs,
  num_folds,
  output_table_name,
  renf90_ped_name
)
}
\arguments{
\item{path_2_execs}{path to a folder that holds all blupf90 executables that ill be used (blupf90+,predictf90). This field should be in quotes "".}

\item{missing_value_code}{code used in the .par file after OPTION MISSING to indicate missing phenotype, if this option is no use, this value must be 0.}

\item{random_effect_col}{Column where random effect is located, found under RANDOM_GROUP in the renf90.par file.}

\item{h2}{estimate of narow-sense heritabilty.This value is use to calculate accuracy of ebvs}

\item{num_runs}{Number of independent cross-valdation runs to be performed.}

\item{num_folds}{Number of folds to be generated within each independent run.}

\item{output_table_name}{Name of the final tab-separated out-up file. This field should be in quotes "".}

\item{renf90_ped_name}{Name of pedigree file generated by renumf90. This field should be in quotes "".}
}
\value{
a tab-separated file that includes accuracy and bias estimates of ebvs.
}
\description{
This function runs a K-fold cross-validation analysis (CVA) using blupf90 modules.
}
\details{
This function sets up and runs a K-fold cross-validation analysis (CVA) using blupf90+ and predictf90.
The function run_renumf90 needs to be used beforehand to process a .par file created by the user.
This function calculates 2 accuracy estimates: correlation between raw phenotypes and ebvs divided by the square-root of narrow sense heritabilty and correlation between corrected phenotypes and ebvs along with bias estimations calculated as the regression of the phenotypes on the ebvs.
}
\examples{
## Example for a CVA with 5 independent runs dividing the data in 10 folds.


# bf90_cv(path_2_execs = "/Users/johndoe/Desktop/bf90_execs/",
#      missing_value_code = -999,
#      random_effect_col= 3,
#      h2 = 0.5,
#      num_runs = 5,
#      num_folds = 10,
#      output_table_name = "example_run",
 #     renf90_ped_name = "renadd03.ped")

#The function will output the file "example_run" with a layout:
# Metric Run Value
# y-ebv_correlation run 1 0.038
# y-ebv_correlation run 2 0.053
# y-ebv_correlation run 3 0.112
# y-ebv_correlation run 4 0.075
# y-ebv_correlation run 5 0.089
# y*-ebv_correlation run 1 0.947
# y*-ebv_correlation run 2 0.964
# y*-ebv_correlation run 3 0.893
# y*-ebv_correlation run 4 0.883
# y*-ebv_correlation run 5 0.939
# bias run 1 0.085
# bias run 2 0.117
# bias run 3 0.262
# bias run 4 0.164
# bias run 5 0.189
# y-ebv_average_corr  0.074
# y*-ebv_accuracy  0.925
# y_corrected_accuracy (yraw_average_corr/sqrt(h2))  0.105
# verage_bias  0.163

}
